plugins {
    id 'org.jetbrains.kotlin.jvm'
}

dependencies {
    api project(':platformlib-ktscript-api')

    api platform("com.fasterxml.jackson:jackson-bom:${project['jackson.version']}")
    api 'com.fasterxml.jackson.core:jackson-databind'
    api 'com.fasterxml.jackson.datatype:jackson-datatype-jdk8'
    api 'com.fasterxml.jackson.datatype:jackson-datatype-jsr310'
    api 'com.fasterxml.jackson.module:jackson-module-kotlin'

    api group: 'net.java.dev.jna', name: 'jna-platform', version: '5.6.0'

    api 'org.jetbrains.kotlin:kotlin-reflect'
    api 'org.jetbrains.kotlin:kotlin-stdlib-jdk8'
    api 'org.jetbrains.kotlin:kotlin-script-runtime'
    api 'org.jetbrains.kotlin:kotlin-stdlib'
    api 'org.jetbrains.kotlin:kotlin-script-util'
    api 'org.jetbrains.kotlin:kotlin-compiler-embeddable'
    api 'org.jetbrains.kotlin:kotlin-scripting-compiler-embeddable'

    compileOnly group: "ch.qos.logback", name: "logback-classic", version: project['logback.version']
}

task coreLibraryDependencies {
    outputs.file(file("$buildDir/resources/main/${project.name}.txt"))
    doFirst {
        def artifacts = ["${project.name}-${project.version}.jar"] + configurations.runtime.files.collect { artifacts.add(it.file.name) }
        outputs.files.singleFile.write(artifacts.join('\n'))
    }
}

processResources {
    from coreLibraryDependencies
}
